def process_metadata_table(self, config_name):
    recent_files = self.get_most_recent_file(config_name)

    if recent_files is None:
        print(f"No XML file found for {config_name}")
        return

    file_path, timestamp = recent_files

    print(f"Processing metadata table: {file_path}")

    xml_parser = XmlParser(file_path, self.collection_configs[config_name], config_name)
    rows = xml_parser.parse_xml_file_metadata()

    if not rows:
        print(f"No metadata rows extracted from {file_path}")
        return

    table_name = f"wasabi_{config_name.lower()}_reporting"

    self.db_manager.ensure_table(table_name, rows[0])
    today = date.today().strftime("%Y-%m-%d")

    self.db_manager.delete_rows_by_date(table_name, today)
    self.db_manager.insert_rows(table_name, rows)

    print(f"Inserted {len(rows)} rows into {table_name}")
